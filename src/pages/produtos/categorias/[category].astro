---
import Layout from "../../../layouts/MainLayout.astro";
import Categoria from "../../../components/produtos/categoria.astro";
import Seo from "../../../lib/seo/metadada.astro";
import '../../../styles/produtos/main.css'

// --- ALTERA√á√ÉO: L√≥gica de Rotas Din√¢micas ---
export async function getStaticPaths() {
  // Defina aqui as categorias que voc√™ quer que existam como p√°ginas.
  // Se quiser pegar do banco na hora do build, voc√™ pode fazer um fetch no supabase aqui tamb√©m.
  return [
    { params: { category: 'eletronicos' } },
    { params: { category: 'casa' } },
    { params: { category: 'cozinha' } },
    { params: { category: 'moda' } },
    { params: { category: 'beleza' } },
    { params: { category: 'fitness' } },
    { params: { category: 'saude' } },
  ];
}

const { category } = Astro.params;

// Formata para ficar bonito no T√≠tulo (ex: eletronicos -> Eletr√¥nicos)
const categoryTitle = category.charAt(0).toUpperCase() + category.slice(1);
---

<Seo
    title={`Promo√ß√µes de ${categoryTitle} | Ba√∫ de Promo√ß√£o`}
    description={`Melhores ofertas de ${categoryTitle} da Amazon, Shopee e Mercado Livre.`}
    type="website">
</Seo>

<Layout>
<div id="page-config" data-category={category} style="display:none;"></div>

    <section class="hero-section" style="position: relative;">
      <div class="faq-wrapper">
        <a href="/" class="btn-back">
          <svg class="icon-back" viewBox="0 0 24 24" fill="none" stroke-width="2.5">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
          </svg>
          Voltar
        </a>

        <h1>Ofertas em {categoryTitle} üî•</h1>
        <p>Os melhores produtos de {categoryTitle} selecionados para voc√™.</p>

        <div class="hero-buttons">
             <a href="/produtos" class="pill-link">
                <button class="pill-btn">
                    <svg class="icon" viewBox="0 0 24 24"><svg viewBox="0 0 576 512"><path d="M309.5-18.9c-4.1-8-12.4-13.1-21.4-13.1s-17.3 5.1-21.4 13.1L193.1 125.3 33.2 150.7c-8.9 1.4-16.3 7.7-19.1 16.3s-.5 18 5.8 24.4l114.4 114.5-25.2 159.9c-1.4 8.9 2.3 17.9 9.6 23.2s16.9 6.1 25 2L288.1 417.6 432.4 491c8 4.1 17.7 3.3 25-2s11-14.2 9.6-23.2L441.7 305.9 556.1 191.4c6.4-6.4 8.6-15.8 5.8-24.4s-10.1-14.9-19.1-16.3L383 125.3 309.5-18.9z"/></svg></svg>
                    Recomendados
                </button>
            </a>
            
            <a href="/produtos/categorias/eletronicos/" class="pill-link">
                <button class={`pill-btn ${category === 'eletronicos' ? 'active' : ''}`}>
                    <svg class="icon" viewBox="0 0 24 24"><svg viewBox="0 0 576 512"> <path d="M348.8 32C340.7 46.1 336 62.5 336 80l0 16-272 0 0 224 272 0 0 64-272 0c-35.3 0-64-28.7-64-64L0 96C0 60.7 28.7 32 64 32l284.8 0zM336 432c0 17.5 4.7 33.9 12.8 48L120 480c-13.3 0-24-10.7-24-24s10.7-24 24-24l216 0zM432 32l96 0c26.5 0 48 21.5 48 48l0 352c0 26.5-21.5 48-48 48l-96 0c-26.5 0-48-21.5-48-48l0-352c0-26.5 21.5-48 48-48zm24 64c-13.3 0-24 10.7-24 24s10.7 24 24 24l48 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-48 0zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24l48 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-48 0zm56 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></svg></svg>
                    Eletr√¥nicos
                </button>
            </a>
            
            <a href="/produtos/categorias/casa/" class="pill-link">
                <button class={`pill-btn ${category === 'casa' ? 'active' : ''}`}>
                    <svg class="icon" viewBox="0 0 24 24"><svg viewBox="0 0 512 512"> <path d="M277.8 8.6c-12.3-11.4-31.3-11.4-43.5 0l-224 208c-9.6 9-12.8 22.9-8 35.1S18.8 272 32 272l16 0 0 176c0 35.3 28.7 64 64 64l288 0c35.3 0 64-28.7 64-64l0-176 16 0c13.2 0 25-8.1 29.8-20.3s1.6-26.2-8-35.1l-224-208zM240 320l32 0c26.5 0 48 21.5 48 48l0 96-128 0 0-96c0-26.5 21.5-48 48-48z"/></svg></svg>
                    Casa
                </button>
            </a>

             <a href="/produtos/categorias/cozinha/" class="pill-link">
                <button class={`pill-btn ${category === 'cozinha' ? 'active' : ''}`}>
                    <svg class="icon" viewBox="0 0 24 24"><svg viewBox="0 0 512 512"> <path d="M247.2 17c-22.1-3.1-44.6 .9-64.4 11.4l-74 39.5C89.1 78.4 73.2 94.9 63.4 115L26.7 190.6c-9.8 20.1-13 42.9-9.1 64.9l14.5 82.8c3.9 22.1 14.6 42.3 30.7 57.9l60.3 58.4c16.1 15.6 36.6 25.6 58.7 28.7l83 11.7c22.1 3.1 44.6-.9 64.4-11.4l74-39.5c19.7-10.5 35.6-27 45.4-47.2l36.7-75.5c9.8-20.1 13-42.9 9.1-64.9l-14.6-82.8c-3.9-22.1-14.6-42.3-30.7-57.9L388.9 57.5c-16.1-15.6-36.6-25.6-58.7-28.7L247.2 17zM208 144a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM144 336a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm224-64a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg></svg>
                    Cozinha
                </button>
            </a>

            <a href="/produtos/categorias/moda/" class="pill-link">
                <button class={`pill-btn ${category === 'moda' ? 'active' : ''}`}>
                    <svg class="icon" viewBox="0 0 24 24"><path d="M20.38 3.46L16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z"></path></svg>
                    Moda
                </button>
            </a>

            <a href="/produtos/categorias/beleza/" class="pill-link">
                <button class={`pill-btn ${category === 'beleza' ? 'active' : ''}`}>
                    <svg class="icon" viewBox="0 0 24 24"><svg viewBox="0 0 576 512"> <path d="M160 32l0 80 128 0 0-80c0-17.7-14.3-32-32-32L192 0c-17.7 0-32 14.3-32 32zm0 128c-53 0-96 43-96 96l0 208c0 26.5 21.5 48 48 48l224 0c26.5 0 48-21.5 48-48l0-208c0-53-43-96-96-96l-128 0zm64 96a80 80 0 1 1 0 160 80 80 0 1 1 0-160zM448 48c0-1.4-1-3-2.2-3.6L416 32 403.6 2.2C403 1 401.4 0 400 0s-3 1-3.6 2.2L384 32 354.2 44.4c-1.2 .6-2.2 2.2-2.2 3.6 0 1.4 1 3 2.2 3.6L384 64 396.4 93.8C397 95 398.6 96 400 96s3-1 3.6-2.2L416 64 445.8 51.6C447 51 448 49.4 448 48zm76.4 45.8C525 95 526.6 96 528 96s3-1 3.6-2.2L544 64 573.8 51.6c1.2-.6 2.2-2.2 2.2-3.6 0-1.4-1-3-2.2-3.6L544 32 531.6 2.2C531 1 529.4 0 528 0s-3 1-3.6 2.2L512 32 482.2 44.4c-1.2 .6-2.2 2.2-2.2 3.6 0 1.4 1 3 2.2 3.6L512 64 524.4 93.8zm7.2 100.4c-.6-1.2-2.2-2.2-3.6-2.2s-3 1-3.6 2.2L512 224 482.2 236.4c-1.2 .6-2.2 2.2-2.2 3.6 0 1.4 1 3 2.2 3.6L512 256 524.4 285.8c.6 1.2 2.2 2.2 3.6 2.2s3-1 3.6-2.2L544 256 573.8 243.6c1.2-.6 2.2-2.2 2.2-3.6 0-1.4-1-3-2.2-3.6L544 224 531.6 194.2zM512 144c0-1.4-1-3-2.2-3.6L480 128 467.6 98.2C467 97 465.4 96 464 96s-3 1-3.6 2.2L448 128 418.2 140.4c-1.2 .6-2.2 2.2-2.2 3.6 0 1.4 1 3 2.2 3.6L448 160 460.4 189.8c.6 1.2 2.2 2.2 3.6 2.2s3-1 3.6-2.2L480 160 509.8 147.6c1.2-.6 2.2-2.2 2.2-3.6z"/></svg></svg>
                    Beleza
                </button>
            </a>

             <a href="/produtos/categorias/fitness/" class="pill-link">
                <button class={`pill-btn ${category === 'fitness' ? 'active' : ''}`}>
                    <svg class="icon" viewBox="0 0 24 24"><svg viewBox="0 0 640 512"> <path d="M96 112c0-26.5 21.5-48 48-48s48 21.5 48 48l0 112 256 0 0-112c0-26.5 21.5-48 48-48s48 21.5 48 48l0 16 16 0c26.5 0 48 21.5 48 48l0 48c17.7 0 32 14.3 32 32s-14.3 32-32 32l0 48c0 26.5-21.5 48-48 48l-16 0 0 16c0 26.5-21.5 48-48 48s-48-21.5-48-48l0-112-256 0 0 112c0 26.5-21.5 48-48 48s-48-21.5-48-48l0-16-16 0c-26.5 0-48-21.5-48-48l0-48c-17.7 0-32-14.3-32-32s14.3-32 32-32l0-48c0-26.5 21.5-48 48-48l16 0 0-16z"/></svg></svg>
                    Fitness
                </button>
            </a>
            <a href="/produtos/categorias/saude/" class="pill-link">
                <button class={`pill-btn ${category === 'saude' ? 'active' : ''}`}>
                    <svg class="icon" viewBox="0 0 22 24">
                        <svg viewBox="0 0 512 512"><path d="M248 24a56 56 0 1 0 -112 0 56 56 0 1 0 112 0zm24 212.7l46.3 62.4c10.5 14.2 30.6 17.2 44.8 6.6s17.2-30.6 6.6-44.8l-70.5-95C274 132 234.3 112 192 112s-82 20-107.2 53.9l-70.5 95c-10.5 14.2-7.6 34.2 6.6 44.8s34.2 7.6 44.8-6.6L112 236.7 112 512c0 17.7 14.3 32 32 32s32-14.3 32-32l0-160c0-8.8 7.2-16 16-16s16 7.2 16 16l0 160c0 17.7 14.3 32 32 32s32-14.3 32-32l0-275.3z"/></svg>
                    </svg>
                    Sa√∫de
                </button>
            </a>

            <a href="/produtos/favoritos/" class="pill-link">
                <button class="pill-btn" data-tab="Favoritos">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    Favoritos
                </button>
            </a>
        </div>

     <div class="search-wrapper" id="search-container-wrapper" style="position: relative;"> 
    <svg class="search-icon" viewBox="0 0 24 24" fill="none">
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
    <input type="text" id="search" autocomplete="off" placeholder=`Procurar em ${categoryTitle}`>
    
    <div id="autocomplete-list" class="autocomplete-list"></div>
</div>
    </section>

    <main class="main-content">
        <button id="mobile-filter-btn" class="pill-btn mobile-only">
            <svg class="icon" viewBox="0 0 24 24"><path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z" /></svg>
            Filtrar Produtos
        </button>

        <div class="shop-container">
            <aside class="sidebar" id="filter-sidebar">
                <div class="sidebar-header mobile-only">
                    <h3>Filtrar</h3>
                    <span class="close-sidebar" onclick="document.getElementById('filter-sidebar').classList.remove('active')">&times;</span>
                </div>

                <div class="filter-group">
                    <h3>Intervalo de Pre√ßo</h3>
                    <div class="price-inputs">
                        <div class="input-wrapper">
                            <span>R$</span>
                            <input type="number" id="min-price" placeholder="M√≠n" min="0">
                        </div>
                        <div class="separator">-</div>
                        <div class="input-wrapper">
                            <span>R$</span>
                            <input type="number" id="max-price" placeholder="M√°x">
                        </div>
                    </div>
                    <button id="btn-apply-price" class="btn-filter-action">Aplicar Pre√ßo</button>
                </div>

                <div class="filter-group">
                    <h3>Vendido por</h3>
                    <label class="custom-checkbox">
                        <input type="checkbox" name="store" value="amazon"><span class="checkmark"></span> Amazon
                    </label>
                    <label class="custom-checkbox">
                        <input type="checkbox" name="store" value="shopee"><span class="checkmark"></span> Shopee
                    </label>
                    <label class="custom-checkbox">
                        <input type="checkbox" name="store" value="mercadolivre"><span class="checkmark"></span> Mercado Livre
                    </label>
                    <label class="custom-checkbox">
                        <input type="checkbox" name="store" value="aliexpress"><span class="checkmark"></span> AliExpress
                    </label>
                </div>

                <div class="filter-group">
                    <h3>Ordenar por</h3>
                    <select id="sort-select" class="filter-select">
                        <option value="relevance">Relev√¢ncia</option>
                        <option value="price_asc">Menor Pre√ßo</option>
                        <option value="price_desc">Maior Pre√ßo</option>
                    </select>
                </div>
            </aside>

            <section class="product-feed">
                <div id="product-grid" class="cards-grid"></div>
                <div style="text-align: center; margin-top: 30px;">
                    <button id="load-more" style="display: none;" class="pill-btn">Carregar Mais</button>
                </div>
            </section>
        </div>
    </main>

    <Categoria client:load/>
</Layout>